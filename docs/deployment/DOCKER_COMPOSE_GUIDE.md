# üê≥ Docker Compose Guide –¥–ª—è TERAG

**–î–∞—Ç–∞:** 2026-01-06  
**–í–µ—Ä—Å–∏—è:** 1.0

---

## üìã –û–±–∑–æ—Ä Docker Compose —Ñ–∞–π–ª–æ–≤

–í –ø—Ä–æ–µ–∫—Ç–µ TERAG –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–æ Docker Compose —Ñ–∞–π–ª–æ–≤ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤:

| –§–∞–π–ª | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ö–æ–Ω—Ç–µ–∫—Å—Ç |
|------|------------|----------|
| `docker-compose.yml` | –û—Å–Ω–æ–≤–Ω–æ–π –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ | –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ |
| `docker-compose.kag.yml` | KAG —Å OpenSPG | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è OpenSPG |
| `docker-compose.kag-simple.yml` | –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π KAG | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `installer/docker-compose.yml` | Production deployment | –ü—Ä–æ–¥–∞–∫—à–Ω |

---

## üõ†Ô∏è docker-compose.yml (–û—Å–Ω–æ–≤–Ω–æ–π)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å –ø–æ–ª–Ω—ã–º —Å—Ç–µ–∫–æ–º

**–°–µ—Ä–≤–∏—Å—ã:**
- `frontend` - React + Vite (–ø–æ—Ä—Ç 5173)
- `backend` - FastAPI (–ø–æ—Ä—Ç 8000)
- `neo4j` - –ì—Ä–∞—Ñ –∑–Ω–∞–Ω–∏–π (–ø–æ—Ä—Ç—ã 7474, 7687)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ó–∞–ø—É—Å–∫
docker-compose up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose down
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ —Å—Ç–µ–∫–∞
- ‚úÖ –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∏ –±—ç–∫–µ–Ω–¥–∞ –≤–º–µ—Å—Ç–µ

---

## üß† docker-compose.kag.yml (KAG —Å OpenSPG)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenSPG –¥–ª—è Graph-RAG

**–°–µ—Ä–≤–∏—Å—ã:**
- `openspg` - OpenSPG API (–ø–æ—Ä—Ç 8080)
- `neo4j` - –ì—Ä–∞—Ñ –∑–Ω–∞–Ω–∏–π
- `supabase` - PostgreSQL –¥–ª—è Memory Bank (–ø–æ—Ä—Ç 5432)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ó–∞–ø—É—Å–∫
docker-compose -f docker-compose.kag.yml up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker-compose -f docker-compose.kag.yml down
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ OpenSPG –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- ‚úÖ –†–∞–±–æ—Ç–∞ —Å KAG Builder —á–µ—Ä–µ–∑ OpenSPG
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Supabase Memory Bank

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ OpenSPG –∏ Supabase

---

## üß™ docker-compose.kag-simple.yml (–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ó–∞–ø—É—Å–∫
docker-compose -f docker-compose.kag-simple.yml up -d
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚ö†Ô∏è –ë—ã—Å—Ç—Ä–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è production)
- ‚ö†Ô∏è –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ú–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ `docker-compose.test.yml`

---

## üöÄ installer/docker-compose.yml (Production)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Production deployment —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º

**–°–µ—Ä–≤–∏—Å—ã:**
- `terag-api` - FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ—Ä—Ç 8000/8001)
- `neo4j` - –ì—Ä–∞—Ñ –∑–Ω–∞–Ω–∏–π
- `prometheus` - –ú–µ—Ç—Ä–∏–∫–∏ (–ø–æ—Ä—Ç 9090)
- `grafana` - –î–∞—à–±–æ—Ä–¥—ã (–ø–æ—Ä—Ç 3000)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ò–∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ installer/
cd installer
docker-compose up -d

# –ò–ª–∏ –∏–∑ –∫–æ—Ä–Ω—è
docker-compose -f installer/docker-compose.yml up -d
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- ‚úÖ Production deployment
- ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏
- ‚úÖ –ü–æ–ª–Ω—ã–π —Å—Ç–µ–∫ —Å Grafana –¥–∞—à–±–æ—Ä–¥–∞–º–∏

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏–∑ `config.env`
- Health checks –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π restart
- Volumes –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –§—É–Ω–∫—Ü–∏—è | –û—Å–Ω–æ–≤–Ω–æ–π | KAG | KAG Simple | Production |
|---------|----------|-----|------------|------------|
| Frontend | ‚úÖ | ‚ùå | ‚ùå | ‚ùå |
| Backend API | ‚úÖ | ‚ùå | ‚ùå | ‚úÖ |
| Neo4j | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| OpenSPG | ‚ùå | ‚úÖ | ‚ö†Ô∏è | ‚ùå |
| Supabase | ‚ùå | ‚úÖ | ‚ö†Ô∏è | ‚ùå |
| Prometheus | ‚ùå | ‚ùå | ‚ùå | ‚úÖ |
| Grafana | ‚ùå | ‚ùå | ‚ùå | ‚úÖ |
| Health Checks | ‚ùå | ‚ùå | ‚ùå | ‚úÖ |
| Auto Restart | ‚ùå | ‚ö†Ô∏è | ‚ùå | ‚úÖ |

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:** `docker-compose.yml`

```bash
docker-compose up -d
```

### –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è KAG

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:** `docker-compose.kag.yml`

```bash
docker-compose -f docker-compose.kag.yml up -d
```

### –î–ª—è production

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:** `installer/docker-compose.yml`

```bash
cd installer
docker-compose up -d
```

---

## üîÑ –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è (–ü–ª–∞–Ω)

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
docker/
‚îú‚îÄ‚îÄ docker-compose.yml          # –û—Å–Ω–æ–≤–Ω–æ–π (dev)
‚îú‚îÄ‚îÄ docker-compose.prod.yml     # Production (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å installer/docker-compose.yml)
‚îú‚îÄ‚îÄ docker-compose.kag.yml      # KAG —Å OpenSPG
‚îî‚îÄ‚îÄ docker-compose.test.yml     # –¢–µ—Å—Ç–æ–≤—ã–π (–ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å kag-simple)
```

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `docker/`
2. –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤—Å–µ docker-compose —Ñ–∞–π–ª—ã –≤ `docker/`
3. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å `installer/docker-compose.yml` ‚Üí `docker/docker-compose.prod.yml`
4. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å—Å—ã–ª–∫–∏ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

---

## üìù –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –û—Å–Ω–æ–≤–Ω–æ–π (docker-compose.yml)

```env
NEO4J_AUTH=neo4j/terag_neo4j_2025
VITE_TERAG_API_URL=http://localhost:8000
```

### Production (installer/docker-compose.yml)

```env
NEO4J_URI=bolt://neo4j:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=${NEO4J_PASSWORD}
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
DATA_PATH=${DATA_PATH}
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

- [ ] –í—ã–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π docker-compose —Ñ–∞–π–ª –¥–ª—è –∑–∞–¥–∞—á–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ—Ä—Ç—ã –Ω–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health checks (–¥–ª—è production)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å volumes –¥–ª—è –ø–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2026-01-06
